<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - EJUST Timetable System</title>
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="login-container">
        <div class="login-card">
            <div class="login-header">
                <div class="login-logo-wrapper">
                    <svg width="150" height="150" viewBox="0 0 240 240" xmlns="http://www.w3.org/2000/svg">
                        <!-- Three top bars -->
                        <rect x="100" y="20" width="12" height="40" fill="#000000" rx="2"/>
                        <rect x="114" y="10" width="12" height="50" fill="#000000" rx="2"/>
                        <rect x="128" y="20" width="12" height="40" fill="#000000" rx="2"/>
                        
                        <!-- Outer circle - left top quarter -->
                        <path d="M 70,120 A 65,65 0 0,1 120,55 L 120,85 A 35,35 0 0,0 100,120 Z" fill="#000000"/>
                        
                        <!-- Outer circle - right top quarter -->
                        <path d="M 170,120 A 65,65 0 0,0 120,55 L 120,85 A 35,35 0 0,1 140,120 Z" fill="#000000"/>
                        
                        <!-- Outer circle - left bottom quarter -->
                        <path d="M 70,120 A 65,65 0 0,0 120,185 L 120,155 A 35,35 0 0,1 100,120 Z" fill="#000000"/>
                        
                        <!-- Outer circle - right bottom quarter -->
                        <path d="M 170,120 A 65,65 0 0,1 120,185 L 120,155 A 35,35 0 0,0 140,120 Z" fill="#000000"/>
                        
                        <!-- Center red sun circle -->
                        <circle cx="120" cy="120" r="42" fill="#E30613"/>
                        
                        <!-- Bottom decorative curves (book pages) -->
                        <path d="M 85,150 Q 95,158 105,156 Q 110,155 115,157" 
                              fill="none" stroke="#000000" stroke-width="2.5" stroke-linecap="round"/>
                        <path d="M 125,157 Q 130,155 135,156 Q 145,158 155,150" 
                              fill="none" stroke="#000000" stroke-width="2.5" stroke-linecap="round"/>
                        <path d="M 90,155 Q 100,162 110,160" 
                              fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round"/>
                        <path d="M 130,160 Q 140,162 150,155" 
                              fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round"/>
                        
                        <!-- Canadian maple leaves -->
                        <g transform="translate(112, 175)">
                            <path d="M 0,-8 L 2,-2 L 8,-1 L 3,1 L 4,7 L 0,3 L -4,7 L -3,1 L -8,-1 L -2,-2 Z" 
                                  fill="#E30613"/>
                        </g>
                        <g transform="translate(128, 175)">
                            <path d="M 0,-8 L 2,-2 L 8,-1 L 3,1 L 4,7 L 0,3 L -4,7 L -3,1 L -8,-1 L -2,-2 Z" 
                                  fill="#E30613"/>
                        </g>
                        
                        <!-- Bottom center vertical line -->
                        <rect x="114" y="180" width="12" height="35" fill="#000000" rx="2"/>
                    </svg>
                </div>
                <div class="login-logo-text">E-JUST</div>
                <div class="login-logo-subtext">Egypt-Japan University of Science and Technology</div>
                <h2 class="login-title">EJUST Timetable System</h2>
                <p class="login-subtitle">Sign in to manage your schedule</p>
            </div>

            <form id="login-form">
                <div class="form-group">
                    <label class="form-label" for="username">Username</label>
                    <input 
                        type="text" 
                        id="username" 
                        name="username" 
                        class="form-control" 
                        required 
                        autocomplete="username"
                        placeholder="Enter your username"
                    >
                </div>

                <div class="form-group">
                    <label class="form-label" for="password">Password</label>
                    <input 
                        type="password" 
                        id="password" 
                        name="password" 
                        class="form-control" 
                        required 
                        autocomplete="current-password"
                        placeholder="Enter your password"
                    >
                </div>

                <button type="submit" class="btn btn-primary btn-lg" style="width: 100%;">
                    Sign In
                </button>
            </form>

            <div class="mt-3 text-center">
                <p class="text-muted" style="font-size: 0.875rem;">
                    Default admin credentials: admin / admin123
                </p>
            </div>
        </div>
    </div>

    <script src="/static/js/auth.js"></script>
    <script src="/static/js/api.js"></script>
    <script src="/static/js/app.js"></script>
    <script>
        // Redirect if already logged in
        if (Auth.isAuthenticated()) {
            const userInfo = Auth.getUserInfo();
            if (userInfo.is_admin) {
                window.location.href = '/static/dashboard.html';
            } else {
                window.location.href = '/static/schedule.html';
            }
        }

        // Handle login form submission
        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();

            if (!validateForm('login-form')) {
                return;
            }

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            try {
                showLoading(true);
                await Auth.login(username, password);
                
                const userInfo = Auth.getUserInfo();
                showNotification('Login successful! Redirecting...', 'success');
                
                setTimeout(() => {
                    if (userInfo.is_admin) {
                        window.location.href = '/static/dashboard.html';
                    } else {
                        window.location.href = '/static/schedule.html';
                    }
                }, 1000);

            } catch (error) {
                showNotification(error.message, 'error');
            } finally {
                showLoading(false);
            }
        });

        // Allow Enter key to submit
        document.querySelectorAll('#username, #password').forEach(input => {
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    document.getElementById('login-form').dispatchEvent(new Event('submit'));
                }
            });
        });
    </script>
</body>
</html>
